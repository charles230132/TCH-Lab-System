name: æ¯10å¤©è‡ªå‹•æ›´æ–°è³‡æ–™åº«

on:
  schedule:
    - cron: '0 0 */10 * *' # æ¯10å¤©åŸ·è¡Œä¸€æ¬¡
  workflow_dispatch:      # å…è¨±æ‰‹å‹•é»æ“ŠæŒ‰éˆ•æ¸¬è©¦

jobs:
  update-data:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write  # â­ é—œéµï¼šçµ¦æ©Ÿå™¨äººå¯«å…¥æ¬Šé™

    steps:
    - name: ä¸‹è¼‰å°ˆæ¡ˆä»£ç¢¼
      uses: actions/checkout@v3

    - name: è¨­å®š Python ç’°å¢ƒ
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: å®‰è£å¥—ä»¶
      run: |
        pip install -r requirements.txt

    - name: åŸ·è¡Œæ›´æ–°ç¨‹å¼
      run: |
        python update_db.py

    - name: å°‡æ–°è³‡æ–™å­˜å› GitHub
      run: |
        git config --global user.name "GitHub Action Bot"
        git config --global user.email "actions@github.com"
        git add lab_test.db
        git commit -m "ğŸ¤– è‡ªå‹•æ›´æ–°è³‡æ–™åº«" || exit 0
        git push
